@ -0,0 +1,218 @@
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title id="page-title">Cargando...</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Arial, sans-serif;
      color: #fff;
      background: #222; /* Color por defecto */
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      margin: 0;
      padding: 0;
    }
    h1 {
      text-align: center;
      background: rgba(0,0,0,0.7);
      padding: 15px;
      margin: 0;
    }
    .category {
      margin: 20px;
      background: rgba(0,0,0,0.6);
      border-radius: 10px;
      padding: 15px;
    }
    .carousel {
      display: flex;
      overflow-x: auto;
      gap: 15px;
      padding-bottom: 10px;
      scroll-behavior: smooth;
    }
    .item {
      flex: 0 0 auto;
      width: 200px;
      background: rgba(255,255,255,0.1);
      border-radius: 8px;
      padding: 15px;
      text-align: center;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .item h3 { margin: 10px 0; font-size: 1.1em; }
    .item p { font-size: 0.9em; color: #ccc; }
    .price-tag { font-weight: bold; color: #ff9800; margin: 10px 0; }
    
    .select-btn {
      padding: 8px;
      background: #ff9800;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }
    .cantidad { margin-top: 8px; font-size: 0.85em; opacity: 0.8; }

    #pedido {
      display: block;
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 15px 30px;
      background: #25D366;
      color: #fff;
      border-radius: 50px;
      text-decoration: none;
      font-weight: bold;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      z-index: 100;
      min-width: 200px;
      text-align: center;
    }
    #menu { padding-bottom: 100px; }
  </style>
</head>
<body>

  <h1 id="main-title">Mi Tienda</h1>
  <div id="menu"></div>
  <a id="pedido" href="#" target="_blank">ðŸ“² Ver Pedido</a>

  <script src="config.js"></script>

  <script>
    let seleccionados = {};
    let tasaBS = 0;

    // Inicializar elementos de la interfaz con el archivo config.js
    function initUI() {
      document.title = APP_CONFIG.nombreTienda;
      document.getElementById('page-title').textContent = APP_CONFIG.nombreTienda;
      document.getElementById('main-title').textContent = APP_CONFIG.emoji + " " + APP_CONFIG.nombreTienda;
      document.body.style.backgroundImage = `url('${APP_CONFIG.imagenFondo}')`;
    }

    async function loadMenu() {
      try {
        initUI();

        // Obtener tasa BCV (usando la API configurada o el fallback de config.js)
        try {
          const dolarRes = await fetch(APP_CONFIG.dolarApi);
          const dolarData = await dolarRes.json();
          tasaBS = dolarData.promedio;
        } catch (e) {
          console.warn("Error con API Dolar, usando tasa manual de config.");
          tasaBS = APP_CONFIG.tasaManual;
        }

        // Obtener datos de Google Sheets
        const res = await fetch(APP_CONFIG.sheetUrl);
        const text = await res.text();
        const rows = text.trim().split("\n").map(r => r.split("\t"));
        const headers = rows[0];
        const data = rows.slice(1);

        const categorias = {};
        data.forEach(row => {
          const item = {};
          headers.forEach((h, i) => item[h.trim()] = row[i]);

          let pUsd, pBs;
          if(item.currency?.toUpperCase() === "USD") {
            pUsd = parseFloat(item.price);
            pBs = (pUsd * tasaBS).toFixed(2);
          } else {
            pBs = parseFloat(item.price);
            pUsd = (pBs / tasaBS).toFixed(2);
          }

          item.pUsd = pUsd;
          item.pBs = pBs;

          if(!categorias[item.category]) categorias[item.category] = [];
          categorias[item.category].push(item);
        });

        renderMenu(categorias);
      } catch (err) {
        document.getElementById("menu").innerHTML = "<p style='text-align:center'>Error cargando el menÃº...</p>";
        console.error(err);
      }
    }

    function renderMenu(categorias) {
      const menuDiv = document.getElementById("menu");
      menuDiv.innerHTML = "";

      Object.keys(categorias).forEach(cat => {
        const catDiv = document.createElement("div");
        catDiv.className = "category";
        catDiv.innerHTML = `<h2>${cat}</h2><div class="carousel"></div>`;
        const carousel = catDiv.querySelector(".carousel");

        categorias[cat].forEach(item => {
          const div = document.createElement("div");
          div.className = "item";
          div.innerHTML = `
            <div>
              <h3>${item.name}</h3>
              <p>${item.description}</p>
            </div>
            <div>
              <div class="price-tag">${item.pUsd} USD / ${item.pBs} Bs</div>
              <button class="select-btn">âž• Agregar</button>
              <div class="cantidad">En el carrito: 0</div>
            </div>
          `;
          
          const btn = div.querySelector(".select-btn");
          const cantDiv = div.querySelector(".cantidad");

          btn.addEventListener("click", () => {
            if(!seleccionados[item.name]) seleccionados[item.name] = {item, cantidad:0};
            seleccionados[item.name].cantidad++;
            cantDiv.textContent = "En el carrito: " + seleccionados[item.name].cantidad;
            actualizarWhatsApp();
          });

          carousel.appendChild(div);
        });
        menuDiv.appendChild(catDiv);
      });
    }

    function actualizarWhatsApp() {
      const btn = document.getElementById("pedido");
      const items = Object.values(seleccionados);
      
      if(items.length === 0) return;

      let totalUsd = 0, totalBs = 0, detalle = "";

      items.forEach(i => {
        const subUsd = i.item.pUsd * i.cantidad;
        const subBs = i.item.pBs * i.cantidad;
        totalUsd += subUsd;
        totalBs += subBs;
        detalle += `- ${i.item.name} x${i.cantidad} (${subUsd.toFixed(2)} USD)\n`;
      });

      const msg = `Â¡Hola! Me gustarÃ­a hacer un pedido en *${APP_CONFIG.nombreTienda}*:\n\n${detalle}\n*TOTAL:* ${totalUsd.toFixed(2)} USD / ${totalBs.toFixed(2)} Bs\n(Tasa: ${tasaBS} Bs)\n\n${APP_CONFIG.mensajeDespedida}`;

      btn.href = `https://wa.me/${APP_CONFIG.whatsapp}?text=${encodeURIComponent(msg)}`;
      btn.textContent = `ðŸ“² Pedir (${items.reduce((a,b)=>a+b.cantidad,0)} items)`;
    }

    loadMenu();
  </script>
</body>
</html>
